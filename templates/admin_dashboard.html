<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ë¦´ë¼ìŠ¤í…Œì´ì…˜ ê´€ë¦¬ìí™ˆ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body {
      background: #fffaf3;
      font-family: 'Segoe UI', sans-serif;
      text-align: center;
      padding: 60px;
    }
    h1 {
      color: #5a4031;
      font-size: 2.3em;
      margin-bottom: 25px;
    }
    .menu-grid {
      display: flex;
      justify-content: center;
      gap: 38px;
      flex-wrap: wrap;
    }
    .menu-card {
      background: #ffe082;
      border-radius: 18px;
      padding: 32px 44px;
      box-shadow: 0 3px 20px #eee7;
      font-size: 1.19em;
      color: #473120;
      margin-bottom: 22px;
      min-width: 220px;
      min-height: 60px;
      display: flex;
      flex-direction: column;
      align-items: center;
      transition: box-shadow 0.2s;
      text-decoration: none;
    }
    .menu-card:hover {
      box-shadow: 0 8px 24px #ffe082b6;
      background: #fffde7;
    }
    .emoji { font-size: 2.3em; margin-bottom: 9px; }

    .archive-form { margin-top: 40px; }
    .archive-btn {
      background-color: #ffcc80;
      color: #5a4031;
      border: none;
      border-radius: 10px;
      padding: 12px 28px;
      font-size: 1.05em;
      font-weight: bold;
      cursor: pointer;
      box-shadow: 0 2px 8px #e4c88a;
      transition: background 0.2s;
    }
    .archive-btn:hover { background-color: #ffe0b2; }

    .note-btn {
      position: fixed;
      bottom: 20px; right: 20px;
      background: #ffd54f;
      border-radius: 50%;
      width: 60px; height: 60px;
      box-shadow: 0 4px 16px rgba(0,0,0,0.2);
      font-size: 26px;
      color: #4e342e;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      z-index: 999;
    }

    .msg-box {
      position: fixed;
      bottom: 90px; right: 20px;
      width: 320px;
      max-height: 420px;
      background: #fffef9;
      border: 2px solid #ffe082;
      border-radius: 16px;
      box-shadow: 0 8px 24px rgba(0,0,0,0.15);
      display: none;
      flex-direction: column;
      z-index: 999;
      overflow: hidden;
    }

    .msg-box-header {
      background: #ffe082;
      padding: 12px;
      font-weight: bold;
      color: #5a4031;
      text-align: center;
    }

    .msg-tabs {
      display: flex;
      background: #fff9ec;
      border-bottom: 1px solid #f0d89d;
    }

    .msg-tabs button {
      flex: 1;
      padding: 10px;
      border: none;
      background: none;
      font-weight: bold;
      color: #6d4c41;
      cursor: pointer;
      transition: background 0.2s;
    }

    .msg-tabs button.active {
      background: #ffe082;
      color: #3e2723;
    }

    .msg-section {
      display: none;
      padding: 12px;
    }
    .msg-section.active {
      display: block;
    }

    .msg-item {
      padding: 10px 14px;
      border-bottom: 1px solid #f5e6c3;
      text-align: left;
    }
    .msg-item strong { display: block; margin-bottom: 4px; color: #4e342e; }
    .msg-item small { color: #a1887f; }

    .msg-compose select, .msg-compose textarea {
      width: 100%;
      margin-bottom: 8px;
      padding: 8px;
      font-size: 0.9em;
      border-radius: 8px;
      border: 1px solid #ddd0b8;
    }

    .msg-compose button {
      background-color: #ffcc80;
      border: none;
      padding: 8px;
      border-radius: 8px;
      font-weight: bold;
      cursor: pointer;
      color: #4e342e;
    }

    .msg-compose button:hover { background-color: #ffe0b2; }
  </style>
</head>
<body>
  <h1>ğŸ“Š ë¦´ë¼ìŠ¤í…Œì´ì…˜ ê´€ë¦¬ìí™ˆ</h1>
  <div class="menu-grid">
    <a class="menu-card" href="/admin/items"><span class="emoji">ğŸ“¦</span>ìƒí’ˆê´€ë¦¬</a>
    <a class="menu-card" href="/admin/items/chart"><span class="emoji">ğŸ“ˆ</span>ì¬ê³  ì²´í¬</a>
    <a class="menu-card" href="/admin/orders"><span class="emoji">ğŸ“œ</span>ì „ì²´ ì£¼ë¬¸ëª©ë¡</a>
    <a class="menu-card" href="/admin/stats"><span class="emoji">ğŸ“Š</span>ì£¼ë¬¸ í†µê³„</a>
    <a class="menu-card" href="/admin/users"><span class="emoji">ğŸ‘¤</span>ì‚¬ìš©ì ê´€ë¦¬</a>
    <a class="menu-card" href="/admin/logs"><span class="emoji">ğŸ“œ</span>í™œë™ ë¡œê·¸</a>
    <a class="menu-card" href="/admin/messages"><span class="emoji">ğŸ“¨</span>ì „ì²´  ìª½ì§€ ê´€ë¦¬</a>
    <a class="menu-card" href="/admin/archive/view"><span class="emoji">ğŸ’ƒï¸</span>ì•„ì¹´ì´ë¸Œ ì¡°íšŒ</a>
    <a class="menu-card" href="/admin/notices"><span class="emoji">ğŸ“¢</span>ê³µì§€ì‚¬í•­ ê´€ë¦¬</a>
    <a class="menu-card" href="/admin/equipments"><span class="emoji">ğŸ“</span>ë¹„í’ˆê´€ë¦¬</a>
    <a class="menu-card" href="/logout"><span class="emoji">ğŸšª</span>ë¡œê·¸ì•„ì›ƒ</a>
  </div>

  <form class="archive-form" method="get" action="/admin/orders/delete_completed_all">
    <button type="submit" class="archive-btn" onclick="return confirm('ğŸ“¦ 6ê°œì›” ì´ìƒëœ ì£¼ë¬¸ì„ ì•„ì¹´ì´ë¸Œ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')">
      ğŸ“¦ ì˜¤ë˜ëœ ì£¼ë¬¸ ì•„ì¹´ì´ë¸Œ
    </button>
  </form>

  <!-- ìª½ì§€í•¨ UI -->
  <div class="note-btn" onclick="toggleMsgBox()">ğŸ’Œ</div>
  <div class="msg-box" id="msgBox">
    <div class="msg-box-header">ìª½ì§€í•¨</div>
    <div class="msg-tabs">
      <button onclick="showTab('inbox')" class="active">ğŸ“¥ ë°›ì€ìª½ì§€</button>
      <button onclick="showTab('compose')">âœï¸ ìƒˆ ìª½ì§€ì‘ì„±</button>
    </div>
    <div class="msg-section active" id="inboxSection">
      {% if messages %}
        {% for msg in messages %}
          <div class="msg-item">
            <strong>{{ msg.sender }}</strong>
            {{ msg.content }}<br>
            <small>{{ msg.timestamp }}</small>
          </div>
        {% endfor %}
      {% else %}
        <div class="msg-item">ğŸ“­ ë°›ì€ ìª½ì§€ê°€ ì—†ìŠµë‹ˆë‹¤.</div>
      {% endif %}
    </div>
    <div class="msg-section" id="composeSection">
      <div class="msg-compose">
        <form method="post" action="/messages/send">
          <select name="to" required>
            <option value="">ë°›ëŠ” ì‚¬ìš©ì ì„ íƒ</option>
            {% for user in recipients %}
              <option value="{{ user.username }}">{{ user.store_name }} ({{ user.username }})</option>
            {% endfor %}
          </select>
          <textarea name="content" rows="4" placeholder="ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”..." required></textarea>
          <button type="submit">ìª½ì§€ ë³´ë‚´ê¸°</button>
        </form>
      </div>
    </div>
  </div>

  <script>
    function toggleMsgBox() {
      const box = document.getElementById('msgBox');
      box.style.display = (box.style.display === 'flex') ? 'none' : 'flex';
      box.style.flexDirection = 'column';
      if (box.style.display === 'flex') showTab('inbox');
    }

    function showTab(tab) {
      document.querySelectorAll('.msg-tabs button').forEach(btn => btn.classList.remove('active'));
      document.getElementById('inboxSection').classList.remove('active');
      document.getElementById('composeSection').classList.remove('active');

      if (tab === 'inbox') {
        document.querySelector('.msg-tabs button:nth-child(1)').classList.add('active');
        document.getElementById('inboxSection').classList.add('active');
      } else {
        document.querySelector('.msg-tabs button:nth-child(2)').classList.add('active');
        document.getElementById('composeSection').classList.add('active');
      }
    }
  </script>
</body>
</html>

